{"id":"ansible-guide","title":"ðŸ“¦ Ansible Zero to Hero","content":"# ðŸš€ Ansible Zero to Hero - Complete Course\n\nA comprehensive course covering Ansible from basics to advanced topics with concise concepts and practical examples.\n\n---\n\n## ðŸ“š Table of Contents\n\n1. [Introduction and Setup](#part-1-introduction-and-setup)\n2. [Inventory Deep Dive](#part-2-inventory-deep-dive)\n3. [Ad-hoc Commands](#part-3-ad-hoc-commands)\n4. [Playbooks Fundamentals](#part-4-playbooks-fundamentals)\n5. [Variables and Facts](#part-5-variables-and-facts)\n6. [Conditionals and Loops](#part-6-conditionals-and-loops)\n7. [Handlers and Templates](#part-7-handlers-and-templates)\n8. [Roles](#part-8-roles)\n9. [Ansible Vault](#part-9-ansible-vault)\n10. [Advanced Topics](#part-10-advanced-topics)\n\n---\n\n## ðŸŽ¯ Learning Path\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                        BEGINNER                                      â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚\nâ”‚  â”‚ 01. Setup    â”‚â”€â”€â”€â–¶â”‚ 02. Inventoryâ”‚â”€â”€â”€â–¶â”‚ 03. Ad-hoc   â”‚          â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                â”‚\n                                â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                      INTERMEDIATE                                    â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚\nâ”‚  â”‚ 04. Playbooksâ”‚â”€â”€â”€â–¶â”‚ 05. Variablesâ”‚â”€â”€â”€â–¶â”‚ 06. Loops    â”‚          â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                â”‚\n                                â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                        ADVANCED                                      â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚\nâ”‚  â”‚ 07. Templatesâ”‚â”€â”€â”€â–¶â”‚ 08. Roles    â”‚â”€â”€â”€â–¶â”‚ 09. Vault    â”‚          â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚\nâ”‚                                                  â”‚                   â”‚\nâ”‚                                                  â–¼                   â”‚\nâ”‚                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚\nâ”‚                                          â”‚ 10. Advanced â”‚           â”‚\nâ”‚                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n---\n\n# Part 1: Introduction and Setup\n\n## What is Ansible?\n\nAnsible is an open-source automation tool used for configuration management, application deployment, and task automation. It uses a simple, human-readable language called YAML and operates over SSH, requiring no agents on managed nodes.\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          SSH          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  Control Node   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶   â”‚  Managed Node   â”‚\nâ”‚  (Your Machine) â”‚                       â”‚  (Target Server)â”‚\nâ”‚  - Ansible      â”‚                       â”‚  - No Agent     â”‚\nâ”‚  - Playbooks    â”‚                       â”‚  - Python only  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n## Why Ansible?\n\nAnsible stands out because it's agentless, meaning you don't need to install any software on target machines. It uses simple YAML syntax that's easy to read and write, making infrastructure as code accessible to everyone.\n\n### Key Benefits\n\n| Feature | Description |\n|---------|-------------|\n| **Agentless** | No software needed on managed nodes |\n| **Simple** | YAML-based, human-readable syntax |\n| **Powerful** | Can manage thousands of nodes |\n| **Idempotent** | Same result regardless of how many times you run it |\n| **Extensible** | Large collection of modules and plugins |\n\n## Ansible Architecture\n\nAnsible follows a push-based architecture where the control node pushes configurations to managed nodes over SSH. The control node contains inventory files (list of hosts), playbooks (automation scripts), and modules (units of work).\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                      CONTROL NODE                           â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚\nâ”‚  â”‚  Inventory  â”‚  â”‚  Playbooks  â”‚  â”‚      Modules        â”‚ â”‚\nâ”‚  â”‚  (hosts)    â”‚  â”‚  (.yml)     â”‚  â”‚  (apt, yum, copy)   â”‚ â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                              â”‚\n                              â”‚ SSH/WinRM\n                              â–¼\n        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n        â”‚              MANAGED NODES                   â”‚\n        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚\n        â”‚  â”‚ Web     â”‚  â”‚ DB      â”‚  â”‚ App     â”‚     â”‚\n        â”‚  â”‚ Server  â”‚  â”‚ Server  â”‚  â”‚ Server  â”‚     â”‚\n        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚\n        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Core Components\n\n| Component | Purpose |\n|-----------|---------|\n| **Control Node** | Machine where Ansible is installed and run from |\n| **Managed Nodes** | Target machines being configured |\n| **Inventory** | List of managed nodes |\n| **Modules** | Units of code that perform specific tasks |\n| **Playbooks** | YAML files containing automation tasks |\n| **Plugins** | Extend Ansible's core functionality |\n\n## Installation\n\n### Installing on Ubuntu/Debian\n\n```bash\n# Update package index\nsudo apt update\n\n# Install software-properties-common\nsudo apt install software-properties-common\n\n# Add Ansible PPA\nsudo add-apt-repository --yes --update ppa:ansible/ansible\n\n# Install Ansible\nsudo apt install ansible\n\n# Verify installation\nansible --version\n```\n\n### Installing on RHEL/CentOS/Rocky Linux\n\n```bash\n# Enable EPEL repository\nsudo dnf install epel-release\n\n# Install Ansible\nsudo dnf install ansible\n\n# Verify installation\nansible --version\n```\n\n### Installing on macOS\n\n```bash\n# Using Homebrew\nbrew install ansible\n\n# Verify installation\nansible --version\n```\n\n### Installing via pip (All Platforms)\n\n```bash\n# Install pip if not present\npython3 -m ensurepip --upgrade\n\n# Install Ansible using pip\npip3 install ansible\n\n# Verify installation\nansible --version\n```\n\n## First Steps\n\n### Creating Your First Inventory\n\nAn inventory file defines the hosts Ansible will manage. Create a simple inventory file listing your target servers with their connection details.\n\n**File: `inventory.ini`**\n\n```ini\n# Simple inventory file\n\n# Single host\nwebserver1 ansible_host=192.168.1.10\n\n# Group of hosts\n[webservers]\nweb1 ansible_host=192.168.1.11\nweb2 ansible_host=192.168.1.12\n\n[dbservers]\ndb1 ansible_host=192.168.1.20\ndb2 ansible_host=192.168.1.21\n\n# Group of groups\n[production:children]\nwebservers\ndbservers\n\n# Variables for a group\n[webservers:vars]\nansible_user=ubuntu\nansible_ssh_private_key_file=~/.ssh/id_rsa\n```\n\n### Testing Connectivity\n\nUse the `ping` module to test if Ansible can connect to your managed nodes.\n\n```bash\n# Ping all hosts in inventory\nansible all -i inventory.ini -m ping\n\n# Ping specific group\nansible webservers -i inventory.ini -m ping\n```\n\n**Expected Output:**\n\n```\nweb1 | SUCCESS => {\n    \"changed\": false,\n    \"ping\": \"pong\"\n}\n```\n\n### Basic ansible.cfg Configuration\n\n**File: `ansible.cfg`**\n\n```ini\n[defaults]\ninventory = ./inventory/production.ini\nremote_user = ubuntu\nhost_key_checking = False\nforks = 10\nretry_files_enabled = False\nroles_path = ./roles\nstdout_callback = yaml\n\n[privilege_escalation]\nbecome = True\nbecome_method = sudo\nbecome_user = root\n\n[ssh_connection]\npipelining = True\n```\n\n---\n\n# Part 2: Inventory Deep Dive\n\n## Inventory Basics\n\nThe inventory is Ansible's source of truth for all managed hosts. It can be a simple static file or dynamically generated from cloud providers.\n\n## INI Format\n\nINI format is the traditional and most common way to define inventory.\n\n```ini\n# Ungrouped hosts\nserver1.example.com\n\n# Web servers group\n[webservers]\nweb1.example.com\nweb2.example.com\n\n# Database servers group\n[dbservers]\ndb1.example.com ansible_host=10.0.0.50\n\n# Numeric patterns - creates web[01-10].example.com\n[webfarm]\nweb[01:10].example.com\n\n# Parent group containing child groups\n[production:children]\nwebservers\ndbservers\n\n# Variables for all production hosts\n[production:vars]\nansible_user=admin\nenvironment=production\n```\n\n## YAML Format\n\nYAML format offers more flexibility and readability for complex inventories.\n\n```yaml\n---\nall:\n  hosts:\n    server1.example.com:\n  \n  children:\n    webservers:\n      hosts:\n        web1.example.com:\n          http_port: 80\n        web2.example.com:\n          http_port: 8080\n      vars:\n        ansible_user: www-data\n    \n    dbservers:\n      hosts:\n        db1.example.com:\n          ansible_host: 10.0.0.50\n          mysql_port: 3306\n      vars:\n        ansible_user: dba\n```\n\n## Host and Group Variables\n\nVariables can be defined in separate files for maintainability.\n\n### Directory Structure\n\n```\ninventory/\nâ”œâ”€â”€ production.ini\nâ”œâ”€â”€ group_vars/\nâ”‚   â”œâ”€â”€ all.yml\nâ”‚   â”œâ”€â”€ webservers.yml\nâ”‚   â””â”€â”€ dbservers.yml\nâ””â”€â”€ host_vars/\n    â””â”€â”€ web1.example.com.yml\n```\n\n### Variable Precedence (Low to High)\n\n```\n1. group_vars/all\n2. group_vars/<group_name>\n3. host_vars/<host_name>\n4. Playbook vars\n5. Extra vars (-e)\n```\n\n## Dynamic Inventory\n\nDynamic inventory scripts generate host information on-the-fly from external sources.\n\n### AWS EC2 Dynamic Inventory\n\n**File: `aws_ec2.yml`**\n\n```yaml\n---\nplugin: amazon.aws.aws_ec2\n\nregions:\n  - us-east-1\n\nfilters:\n  instance-state-name: running\n\nkeyed_groups:\n  - key: tags.Environment\n    prefix: env\n  - key: tags.Role\n    prefix: role\n\ncompose:\n  ansible_host: public_ip_address\n```\n\n```bash\n# Test dynamic inventory\nansible-inventory -i aws_ec2.yml --list\n```\n\n---\n\n# Part 3: Ad-hoc Commands\n\n## What are Ad-hoc Commands?\n\nAd-hoc commands are one-liner Ansible commands that execute a single task on target hosts. They're perfect for quick tasks without writing a full playbook.\n\n```bash\n# Basic syntax\nansible <pattern> -m <module> -a \"<arguments>\"\n```\n\n## Common Modules\n\n### ping Module\n\n```bash\nansible all -m ping\n```\n\n### command Module\n\n```bash\nansible all -m command -a \"uptime\"\nansible all -m command -a \"df -h\"\nansible all -a \"hostname\"  # -m command is default\n```\n\n### shell Module\n\n```bash\nansible all -m shell -a \"ps aux | grep nginx | wc -l\"\nansible all -m shell -a \"df -h > /tmp/disk_report.txt\"\n```\n\n### copy Module\n\n```bash\nansible all -m copy -a \"src=/local/file.txt dest=/remote/file.txt\"\nansible all -m copy -a \"src=/local/script.sh dest=/usr/local/bin/script.sh mode=0755\"\n```\n\n### file Module\n\n```bash\nansible all -m file -a \"path=/app/data state=directory mode=0755\"\nansible all -m file -a \"path=/tmp/unwanted.txt state=absent\"\n```\n\n### apt Module (Debian/Ubuntu)\n\n```bash\nansible webservers -m apt -a \"name=nginx state=present\" -b\nansible webservers -m apt -a \"upgrade=yes update_cache=yes\" -b\n```\n\n### service Module\n\n```bash\nansible webservers -m service -a \"name=nginx state=started enabled=yes\" -b\nansible webservers -m service -a \"name=nginx state=restarted\" -b\n```\n\n### user Module\n\n```bash\nansible all -m user -a \"name=deploy state=present\" -b\nansible all -m user -a \"name=deploy groups=docker,sudo append=yes\" -b\n```\n\n### setup Module\n\n```bash\nansible all -m setup\nansible all -m setup -a \"filter=ansible_distribution*\"\n```\n\n## Privilege Escalation\n\n```bash\nansible all -m apt -a \"name=nginx state=present\" -b\nansible all -m command -a \"whoami\" -b --become-user=postgres\nansible all -m apt -a \"name=nginx state=present\" -b -K  # Ask for sudo password\n```\n\n---\n\n# Part 4: Playbooks Fundamentals\n\n## What are Playbooks?\n\nPlaybooks are YAML files that define automation workflows consisting of one or more plays. Each play targets specific hosts and contains a list of tasks to execute in order.\n\n## Playbook Structure\n\n```yaml\n---\n- name: Configure web servers\n  hosts: webservers\n  become: yes\n  gather_facts: yes\n  \n  vars:\n    http_port: 80\n    \n  tasks:\n    - name: Install nginx\n      apt:\n        name: nginx\n        state: present\n        \n    - name: Start nginx\n      service:\n        name: nginx\n        state: started\n        enabled: yes\n```\n\n## Tasks and Modules\n\n### Package Management\n\n```yaml\n- name: Install packages\n  apt:\n    name:\n      - nginx\n      - php-fpm\n      - mysql-client\n    state: present\n    update_cache: yes\n```\n\n### File Operations\n\n```yaml\n- name: Copy configuration\n  copy:\n    src: nginx.conf\n    dest: /etc/nginx/nginx.conf\n    owner: root\n    mode: '0644'\n  notify: Restart nginx\n\n- name: Deploy configuration from template\n  template:\n    src: app.conf.j2\n    dest: /etc/app/app.conf\n```\n\n### Service Management\n\n```yaml\n- name: Start and enable nginx\n  service:\n    name: nginx\n    state: started\n    enabled: yes\n```\n\n## Running Playbooks\n\n```bash\nansible-playbook playbook.yml\nansible-playbook -i inventory.ini playbook.yml\nansible-playbook playbook.yml --limit webservers\nansible-playbook playbook.yml --check --diff\nansible-playbook playbook.yml -e \"env=production\"\n```\n\n## Tags\n\n```yaml\ntasks:\n  - name: Install dependencies\n    apt:\n      name: nginx\n      state: present\n    tags: [packages, setup]\n      \n  - name: Copy configuration\n    template:\n      src: nginx.conf.j2\n      dest: /etc/nginx/nginx.conf\n    tags: [config]\n```\n\n```bash\nansible-playbook playbook.yml --tags \"config\"\nansible-playbook playbook.yml --skip-tags \"restart\"\n```\n\n---\n\n# Part 5: Variables and Facts\n\n## Understanding Variables\n\nVariables in Ansible store values that can be reused throughout playbooks.\n\n```yaml\nvars:\n  app_name: myapp\n  http_port: 8080\n  \ntasks:\n  - name: Create directory\n    file:\n      path: \"/opt/{{ app_name }}\"\n      state: directory\n```\n\n## Variable Types and Sources\n\n### Playbook Variables\n\n```yaml\nvars:\n  app_name: myapp\n  packages:\n    - nginx\n    - python3\n  database:\n    host: db.example.com\n    port: 5432\n```\n\n### Variables from Files\n\n```yaml\nvars_files:\n  - vars/common.yml\n  - \"vars/{{ env }}.yml\"\n```\n\n### Registered Variables\n\n```yaml\n- name: Get current date\n  command: date +%Y%m%d\n  register: current_date\n  \n- name: Use date in filename\n  file:\n    path: \"/backup/backup_{{ current_date.stdout }}.tar.gz\"\n    state: touch\n```\n\n### Extra Variables (Command Line)\n\n```bash\nansible-playbook deploy.yml -e \"version=1.2.3 env=production\"\nansible-playbook deploy.yml -e \"@vars/deploy.yml\"\n```\n\n### set_fact\n\n```yaml\n- name: Calculate memory for app\n  set_fact:\n    app_memory: \"{{ (ansible_memtotal_mb * 0.6) | int }}M\"\n```\n\n## Facts\n\nFacts are system information automatically gathered by Ansible.\n\n```yaml\n# Common Facts\nansible_distribution       # Ubuntu, CentOS, etc.\nansible_distribution_version\nansible_os_family          # Debian, RedHat, etc.\nansible_hostname\nansible_default_ipv4.address\nansible_memtotal_mb\nansible_processor_vcpus\n```\n\n## Magic Variables\n\n```yaml\ninventory_hostname      # Name as defined in inventory\ngroup_names             # List of groups current host belongs to\ngroups                  # Dict of all groups and their hosts\nhostvars                # Variables for all hosts\nansible_play_hosts      # All hosts in current play\n```\n\n---\n\n# Part 6: Conditionals and Loops\n\n## Conditionals with when\n\n```yaml\n- name: Install on Ubuntu only\n  apt:\n    name: nginx\n    state: present\n  when: ansible_distribution == \"Ubuntu\"\n\n- name: Configure if web server\n  template:\n    src: web.conf.j2\n    dest: /etc/app/web.conf\n  when: \"'webservers' in group_names\"\n```\n\n## Complex Conditions\n\n```yaml\n# AND conditions (list format)\n- name: Configure production web servers\n  template:\n    src: prod.conf.j2\n    dest: /etc/app/config.conf\n  when:\n    - env == \"production\"\n    - server_type == \"web\"\n\n# OR conditions\n- name: Install on Debian-based systems\n  apt:\n    name: nginx\n    state: present\n  when: ansible_distribution in [\"Ubuntu\", \"Debian\"]\n```\n\n## Testing Variable State\n\n```yaml\n- name: Use variable if defined\n  debug:\n    msg: \"Port is {{ custom_port }}\"\n  when: custom_port is defined\n\n- name: Check path exists\n  stat:\n    path: /opt/app\n  register: app_dir\n  \n- name: Install if directory exists\n  command: /opt/app/install.sh\n  when: app_dir.stat.exists and app_dir.stat.isdir\n```\n\n## Loops\n\n### Basic Loop\n\n```yaml\n- name: Install multiple packages\n  apt:\n    name: \"{{ item }}\"\n    state: present\n  loop:\n    - nginx\n    - php-fpm\n    - mysql-client\n```\n\n### Loop over Dictionaries\n\n```yaml\nvars:\n  users:\n    - name: alice\n      groups: developers\n    - name: bob\n      groups: admins\n\ntasks:\n  - name: Create users\n    user:\n      name: \"{{ item.name }}\"\n      groups: \"{{ item.groups }}\"\n    loop: \"{{ users }}\"\n```\n\n### until - Retry Loops\n\n```yaml\n- name: Wait for service to start\n  uri:\n    url: http://localhost:8080/health\n    status_code: 200\n  register: result\n  until: result.status == 200\n  retries: 30\n  delay: 10\n```\n\n---\n\n# Part 7: Handlers and Templates\n\n## Understanding Handlers\n\nHandlers are special tasks that run only when notified by other tasks. They typically run once at the end of a play.\n\n```yaml\ntasks:\n  - name: Update nginx configuration\n    template:\n      src: nginx.conf.j2\n      dest: /etc/nginx/nginx.conf\n    notify: Restart nginx\n    \nhandlers:\n  - name: Restart nginx\n    service:\n      name: nginx\n      state: restarted\n```\n\n### Multiple Handlers\n\n```yaml\ntasks:\n  - name: Update nginx config\n    template:\n      src: nginx.conf.j2\n      dest: /etc/nginx/nginx.conf\n    notify:\n      - Validate nginx config\n      - Restart nginx\n      \nhandlers:\n  - name: Validate nginx config\n    command: nginx -t\n    \n  - name: Restart nginx\n    service:\n      name: nginx\n      state: restarted\n```\n\n## Jinja2 Templates\n\nTemplates are files processed by the Jinja2 templating engine.\n\n**File: `templates/nginx.conf.j2`**\n\n```jinja2\n# Ansible managed - do not edit manually\nuser {{ nginx_user | default('www-data') }};\nworker_processes {{ nginx_worker_processes | default('auto') }};\n\nevents {\n    worker_connections {{ nginx_worker_connections | default(1024) }};\n}\n\nhttp {\n    keepalive_timeout {{ nginx_keepalive_timeout | default(65) }};\n    include /etc/nginx/sites-enabled/*;\n}\n```\n\n## Template Syntax\n\n### Variables\n\n```jinja2\nserver_name {{ server_name }};\nlisten {{ http_port | default(80) }};\nhost {{ database.host }}:{{ database.port }};\n```\n\n### Conditionals\n\n```jinja2\n{% if ssl_enabled %}\nlisten 443 ssl;\nssl_certificate {{ ssl_certificate }};\n{% else %}\nlisten 80;\n{% endif %}\n```\n\n### Loops\n\n```jinja2\n{% for server in upstream_servers %}\nserver {{ server }};\n{% endfor %}\n```\n\n### Filters\n\n```jinja2\n{{ hostname | upper }}\n{{ items | join(', ') }}\n{{ variable | default('fallback') }}\n{{ data | to_json }}\n```\n\n---\n\n# Part 8: Roles\n\n## What are Roles?\n\nRoles are a way to organize playbooks into reusable, self-contained units. They package tasks, handlers, variables, templates, and files into a standardized structure.\n\n## Role Structure\n\n```\nroles/\nâ””â”€â”€ nginx/\n    â”œâ”€â”€ defaults/\n    â”‚   â””â”€â”€ main.yml       # Default variables (lowest priority)\n    â”œâ”€â”€ vars/\n    â”‚   â””â”€â”€ main.yml       # Role variables (higher priority)\n    â”œâ”€â”€ tasks/\n    â”‚   â””â”€â”€ main.yml       # Main task file\n    â”œâ”€â”€ handlers/\n    â”‚   â””â”€â”€ main.yml       # Handler definitions\n    â”œâ”€â”€ templates/\n    â”‚   â””â”€â”€ nginx.conf.j2  # Jinja2 templates\n    â”œâ”€â”€ files/\n    â”‚   â””â”€â”€ index.html     # Static files\n    â”œâ”€â”€ meta/\n    â”‚   â””â”€â”€ main.yml       # Role metadata and dependencies\n    â””â”€â”€ README.md          # Documentation\n```\n\n## Creating Roles\n\n```bash\nansible-galaxy init nginx\nansible-galaxy init --init-path=./roles nginx\n```\n\n## Using Roles\n\n```yaml\n- name: Configure web servers\n  hosts: webservers\n  become: yes\n  \n  roles:\n    - nginx\n    - php-fpm\n    - role: mysql\n      vars:\n        mysql_port: 3306\n```\n\n## Role Dependencies\n\n**File: `roles/wordpress/meta/main.yml`**\n\n```yaml\n---\ndependencies:\n  - role: nginx\n  - role: php-fpm\n    vars:\n      php_version: \"8.1\"\n  - role: mysql\n```\n\n## Ansible Galaxy\n\n```bash\n# Install role\nansible-galaxy install geerlingguy.nginx\n\n# Install from requirements file\nansible-galaxy install -r requirements.yml\n```\n\n**File: `requirements.yml`**\n\n```yaml\n---\nroles:\n  - name: geerlingguy.nginx\n    version: \"3.1.0\"\n  - name: geerlingguy.mysql\n    version: \"4.3.0\"\n```\n\n---\n\n# Part 9: Ansible Vault\n\n## What is Ansible Vault?\n\nAnsible Vault encrypts sensitive data such as passwords, API keys, and certificates using AES-256 encryption.\n\n## Creating Encrypted Files\n\n```bash\nansible-vault create secrets.yml\nansible-vault create --vault-password-file .vault_pass secrets.yml\n```\n\n## Managing Encrypted Files\n\n```bash\nansible-vault encrypt vars/production.yml\nansible-vault decrypt secrets.yml\nansible-vault view secrets.yml\nansible-vault edit secrets.yml\nansible-vault rekey secrets.yml\n```\n\n## Encrypt Single Variables\n\n```bash\nansible-vault encrypt_string 'MySecretPassword' --name 'db_password'\n```\n\nOutput:\n\n```yaml\ndb_password: !vault |\n          $ANSIBLE_VAULT;1.1;AES256\n          61626364656667...\n```\n\n## Using Encrypted Variables\n\n```yaml\n# group_vars/production/vault.yml (encrypted)\nvault_db_password: ProductionPassword123!\n\n# group_vars/production/vars.yml (plain)\ndb_password: \"{{ vault_db_password }}\"\n```\n\n## Managing Vault Passwords\n\n```bash\n# Prompt at runtime\nansible-playbook playbook.yml --ask-vault-pass\n\n# Password file\nansible-playbook playbook.yml --vault-password-file .vault_pass\n\n# Configure in ansible.cfg\n# vault_password_file = .vault_pass\n```\n\n## Best Practices\n\n1. **Prefix vault variables** with `vault_`\n2. **Use no_log** for sensitive tasks\n3. **Never commit** unencrypted secrets\n4. **Use pre-commit hooks** to prevent accidents\n\n---\n\n# Part 10: Advanced Topics\n\n## Error Handling\n\n### ignore_errors\n\n```yaml\n- name: This might fail\n  command: /opt/app/risky-command.sh\n  ignore_errors: yes\n```\n\n### failed_when\n\n```yaml\n- name: Check application status\n  command: /opt/app/healthcheck.sh\n  register: health\n  failed_when: \"'CRITICAL' in health.stdout\"\n```\n\n### changed_when\n\n```yaml\n- name: Run idempotent script\n  command: /opt/app/configure.sh\n  changed_when: false\n```\n\n## Blocks\n\n```yaml\n- name: Deploy with error handling\n  block:\n    - name: Pull latest code\n      git:\n        repo: https://github.com/company/app.git\n        dest: /opt/app\n        \n    - name: Run migrations\n      command: /opt/app/migrate.sh\n      \n  rescue:\n    - name: Rollback to previous version\n      git:\n        repo: https://github.com/company/app.git\n        dest: /opt/app\n        version: \"{{ previous_version }}\"\n        \n  always:\n    - name: Clean up temp files\n      file:\n        path: /tmp/deploy\n        state: absent\n```\n\n## Asynchronous Actions\n\n```yaml\n- name: Start background task\n  command: /opt/scripts/background-task.sh\n  async: 3600\n  poll: 0\n  register: background_task\n\n- name: Check background task status\n  async_status:\n    jid: \"{{ background_task.ansible_job_id }}\"\n  register: job_result\n  until: job_result.finished\n  retries: 60\n  delay: 10\n```\n\n## Strategies\n\n```yaml\n# Serial execution (rolling deployment)\n- name: Rolling deployment\n  hosts: webservers\n  serial: 2  # 2 hosts at a time\n  \n# Free strategy\n- name: Fast parallel execution\n  hosts: all\n  strategy: free\n```\n\n## Performance Optimization\n\n```ini\n# ansible.cfg\n[defaults]\ngathering = smart\nfact_caching = jsonfile\nfact_caching_connection = /tmp/ansible_facts\nforks = 50\n\n[ssh_connection]\npipelining = True\n```\n\n## CI/CD Integration\n\n### GitHub Actions\n\n```yaml\nname: Deploy with Ansible\n\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      - name: Install Ansible\n        run: pip install ansible\n      - name: Setup SSH key\n        run: |\n          mkdir -p ~/.ssh\n          echo \"${{ secrets.SSH_PRIVATE_KEY }}\" > ~/.ssh/id_rsa\n          chmod 600 ~/.ssh/id_rsa\n      - name: Run Ansible playbook\n        run: ansible-playbook -i inventory/production playbooks/deploy.yml\n```\n\n---\n\n## ðŸŽ‰ Congratulations!\n\nYou've completed the Ansible Zero to Hero course! You now have the knowledge to:\n\n- âœ… Set up and configure Ansible\n- âœ… Write playbooks and use modules\n- âœ… Work with variables, facts, and templates\n- âœ… Create reusable roles\n- âœ… Secure secrets with Vault\n- âœ… Handle errors gracefully\n- âœ… Optimize performance\n- âœ… Integrate with CI/CD pipelines\n\n---\n\n## ðŸ“š Additional Resources\n\n- [Official Ansible Documentation](https://docs.ansible.com/)\n- [Ansible Galaxy](https://galaxy.ansible.com/)\n- [Ansible GitHub Repository](https://github.com/ansible/ansible)\n- [Jinja2 Documentation](https://jinja.palletsprojects.com/)\n\n---\n\n**Happy Automating! ðŸŽ‰**\n\n"}